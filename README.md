# structural-RNA-project

M2 GENIOMHE 2025-2026 - creation of an objective function for the RNA folding problem

This projects aim to develop a library, command line tool and pipeline to score predicted RNA tertiary structures based on their structural feautures. The project is part of the M2 GENIOMHE curriculum at Paris-Saclay University for the academic year 2025-2026. The project is supervised by Professor Guillaume Postic. The team is composed of the following members: Rayane Adams, Joelle Assas, Yazid Hoblos, Denys Buryi and Raul Duran De Alba.

## Project Structure

The project is originally composed of 4 main scripts:

- `data_preparation.py`: This script is responsible for preparing and preprocessing the RNA structural data for analysis. It inputs a list of PDB IDs, feteches the corresponding PDB files, and extracts relevant structural features. It allows the user to define which chain to analyze in the format of a .cvs file or text file. It is meant to accept both PDB legacy files and PDBx/mmCIF files if provided by the user. It extracts a matrix where each row corresponds to an atom, only C3´or C5´atoms, and each column to a feature. The main features extracted are:
  - Protein Data Bank (PDB) ID
  - Atom type
  - Residue type
  - Chain identifier
  - Residue sequence number
  - 3D coordinates (x, y, z)
  
  Then it measures the distances between pairs of amino acid residues based on their 3D coordinates as a residue from the C3' atom in the ribose sugar or the C5' atom, this is defined by the user. It doesn't compute the intramolecular distances of the residues close to it (i+4). The output is saved in a structured format (e.g., CSV or JSON) for further analysis. The output file has the structure of:
    ```PDB_ID,Residue_Type_1,Chain_ID_1,Residue_Seq_Num_1,X_Coord_1,Y_Coord_1,Z_Coord_1,Residue_Type_2,Chain_ID_2,Residue_Seq_Num_2,X_Coord_2,Y_Coord_2,Z_Coord_2,Distance```


- `training.py`: This script is design to create multiple frequency tables based on the structural features extracted from the RNA data. It takes as input the preprocessed data from `data_preparation.py` and computes the frequency distributions for the distances between pairs of amino acid residues (either intra- or inter-chain). It considers distance between the pairs A-U and U-A to be part of the same distribution, and creates also a general distribution for all residues against all residues, called X-X. Thus we end with 11 frequency tables with 20 distances intervals each (0 to 20 Å). The user can specify if it's using intra-chain or inter-chain distances between residues. Then this frequency data is used to build a statististical scoring function for RNA tertiary structure prediction. It used the following formula to compute the frequencies:
  
  $\ f(d) = \frac{N(d)}{N_{total}}$
  
  where $\ f(d)$ is the frequency of observing a distance $ d $, $ N(d) $ is the number of occurrences of distance $ d $, and $ N_{total} $ is the total number of observed distances. Then this frequency is converted into a score using the negative logarithm:
  $ S(d) = -\log(f(d)) $ considered as a pseudo-energy score of the structure. The training script should, therefore, generate 10 files of 20 lines (1 line = 1 scoring value). where the maximum scoring value will be arbitrarily set to 10. The output consists of scoring tables saved in a structured format (e.g., CSV or JSON) for use in the scoring function. The output files have the structure of:
    ```Distance,Score```

- `plotting.py`: This script is responsible for visualizing the frequency distributions and scoring functions generated during the training phase. As well as the corresponding interaction profiles between distance and score. It takes as input the frequency tables and scoring tables produced by `training.py` and creates graphical representations to help interpret the data. The script generates plots that display the frequency of distances between pairs of amino acid residues, as well as the corresponding scoring functions derived from these frequencies. The output consists of image files that illustrate the frequency distributions and scoring functions, which can be used for analysis and presentation purposes. The output files are named according to the residue pairs they represent, such as:
    ```Frequency_Distribution_A-U.png```
    ```Scoring_Function_A-U.png```
    ```Interaction_Profile_A-U.png```

- `scoring.py`: This script implements the scoring function for RNA tertiary structure prediction using the frequency tables generated by `training.py`. It takes as input a predicted RNA structure (in PDB format) and computes a score based on the distances between pairs of amino acid residues  for a given structure (same thresholds: 20 Å and i: i+4). The script reads the scoring tables created during the training phase and uses them to evaluate the predicted structure. For each pair of residues in the predicted structure, it calculates the distance and socres them using linear interpolation from the values in the corresponding scoring tables. The total score for the structure is then computed by summing the individual scores for all residue pairs to calculate the estimated Gibbs free energy of the evaluated RNA conformation. The output is a single score representing the quality of the predicted RNA tertiary structure, which can be used to compare different predictions or guide further refinement. The output file has the structure of:
    ```PDB_ID,Total_Score```
